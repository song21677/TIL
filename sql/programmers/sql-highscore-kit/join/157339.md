# 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기
## 문제 난이도 및 유형
* [문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/157339)
* level4
* INNER JOIN
  * 논리 연산자 AND, OR
  * 비교 연산자 BETWEEN AND, NOT IN()

<br><br>

## 내 풀이
```sql
SELECT CAR_ID, C.CAR_TYPE, FLOOR(DAILY_FEE*30*(1-DISCOUNT_RATE*0.01)) AS FEE
FROM CAR_RENTAL_COMPANY_CAR C
JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN D
ON C.CAR_TYPE = D.CAR_TYPE
WHERE CAR_ID NOT IN (
    SELECT CAR_ID
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE START_DATE < '2022-12-01' AND END_DATE >= '2022-11-01'
)
AND (C.CAR_TYPE = '세단' OR C.CAR_TYPE = 'SUV') 
AND D.DURATION_TYPE = '30일 이상'
AND (DAILY_FEE*30*(1-DISCOUNT_RATE*0.01) BETWEEN 500000 AND 1999999)
ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC
```