## 이상 현상(Anomaly)

테이블 내의 데이터들이 불필요하게 중복되어 테이블을 조작할 때 발생되는 데이터 불일치 현상이다.

다음은 상품 옵션을 담고 있는 테이블이다.

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| S | 블랙 |
| M | 블랙 |
| L | 블랙 |

<br><br>

### 1. 삽입 이상(insertion anomaly)

불필요한 데이터를 추가해야 삽입하게 되면서 발생하는 문제점이다.

**새로운 색상이 나와 테이블에 추가한다면**, 다음과 같이 색상만 추가하는 것이 아니라 상품 사이즈와 함께 추가해줘야 한다.

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| S | 블랙 |
| M | 블랙 |
| L | 블랙 |
| S | 화이트 |
| M | 화이트 |
| L | 화이투 |

그렇다면 S, M, L, 블랙, 화이트와 같이 **중복된 데이터**가 발생한다.

중복 데이터가 발생하면 어떠한 문제점이 있을까??

일단 **저장공간이 낭비**된다. 또한, 마지막 튜플처럼 **실수로 인한 데이터 불일치**가 발생할 수도 있으며 추가를 덜 해 **튜플이 누락**될 수도 있다.

---

**원 사이즈인 상품이어서 색상만 옵션을 준다면?**  다음과 같이 상품 사이즈에 null을 줄 수도 있다.

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| null | 블랙 |
| null | 화이트 |

<br><br>

**추후에 사이즈가 추가된다면?**

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| null | 블랙 |
| null | 화이트 |
| M | 블랙 |
| L | 블랙 |
| M | 화이트 |
| L | 화이트 |

처음에 추가한 두 튜플을 지워야 하는 번거로움이 발생한다.

<br><br>
또한, 할 수 있는 한 NULL 값은 적게 쓰는 것이 좋다고 한다. 다음의 이유들로..

- NULL값이 있는 칼럼으로 join하는 경우 상황에 따라 예상과 다른 결과 발생
- null 값이 있는 칼럼에 aggregate function을 사용했을 때 주의 필요
- 불필요한 storage 낭비
<br><br>

### 2. 삭제 이상(deletion anomaly)

하나의 자료만 삭제하고 싶지만, 그 자료가 포함된 튜플 전체가 삭제됨으로 원하지 않는 정보 손실이 발생하는 문제점이다.

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| S | 블랙 |
| M | 블랙 |
| L | 블랙 |

화이트 색상이 더이상 나오지 않아 블랙 색상만 판매하려고 한다 하자. 그대로 놔둬도 되겠지만.. 색상 옵션을 삭제하고 싶어 삭제하게 된다면 상품 사이즈까지 같이 삭제된다. 
<br><br>

### 3. 갱신 이상(update anomaly)

일부만 변경하여 데이터가 불일치하는 모순, 또는 중복되는 튜플이 존재하게 되는 문제점

상품 사이즈 표현을 다음과 같이 수정했는데 다음과 같이 일부만 변경되어 데이터가 불일치하는 문제점이 발생할 수 있다.

| 상품 사이즈 | 상품 색상 |
| --- | --- |
| S(90) | 블랙 |
| M(95) | 블랙 |
| L(100) | 블랙 |
| S | 화이트 |
| M | 화이트 |
| L | 화이트 |

<br>

1. 의미적으로 관련있는 속성들끼리 
2. 중복 데이터를 최대한 허용하지 않도록
3. join 수행 시 가짜 데이터가 생기지 않도록(pk, fk 잘 활용)
4. 되도록이면 null값을 줄일 수 있는 방향으로 설계
<br><br>

### Reference

- [https://www.youtube.com/watch?v=JwfQ8ouhAzA&ab_channel=쉬운코드](https://www.youtube.com/watch?v=JwfQ8ouhAzA&ab_channel=%EC%89%AC%EC%9A%B4%EC%BD%94%EB%93%9C)
